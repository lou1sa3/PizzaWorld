<app-sidebar></app-sidebar>
<div class="layout-dashboard p-p-4">
  <ng-container *ngIf="!loading && !error && kpis; else loadingOrError">
    <div class="p-grid p-nogutter p-mb-4">
      <div class="p-col-12 p-md-12 p-lg-12">
        <p-card>
          <ng-template pTemplate="content">
            <div class="dashboard-card sakai-card-orange dashboard-kpi-row p-d-flex p-ai-center">
              <i class="pi pi-wallet dashboard-kpi-icon"></i>
              <div class="dashboard-kpi-value">{{ kpis.revenue | number:'1.2-2' }} €</div>
              <span class="kpi-label-under">Total Revenue</span>
            </div>
          </ng-template>
        </p-card>
      </div>
    </div>
    <div class="kpi-row-4">
      <div>
        <p-card>
          <ng-template pTemplate="content">
            <div class="dashboard-card dashboard-kpi-row p-d-flex p-ai-center" style="flex-direction:column;align-items:flex-start;">
              <div class="dashboard-kpi-value">{{ kpis.orders | number }}</div>
              <span class="kpi-label-under">Orders</span>
            </div>
          </ng-template>
        </p-card>
      </div>
      <div>
        <p-card>
          <ng-template pTemplate="content">
            <div class="dashboard-card dashboard-kpi-row p-d-flex p-ai-center" style="flex-direction:column;align-items:flex-start;">
              <div class="dashboard-kpi-value">{{ kpis.avgOrder | number:'1.2-2' }} €</div>
              <span class="kpi-label-under">Avg. Order</span>
            </div>
          </ng-template>
        </p-card>
      </div>
      <div>
        <p-card>
          <ng-template pTemplate="content">
            <div class="dashboard-card dashboard-kpi-row p-d-flex p-ai-center" style="flex-direction:column;align-items:flex-start;">
              <div class="dashboard-kpi-value">{{ kpis.customers | number }}</div>
              <span class="kpi-label-under">Customers</span>
            </div>
          </ng-template>
        </p-card>
      </div>
      <div>
        <p-card>
          <ng-template pTemplate="content">
            <div class="dashboard-card dashboard-kpi-row p-d-flex p-ai-center" style="flex-direction:column;align-items:flex-start;">
              <div class="dashboard-kpi-value">{{ kpis.products | number }}</div>
              <span class="kpi-label-under">Products</span>
            </div>
          </ng-template>
        </p-card>
      </div>
    </div>
  </ng-container>
  <ng-template #loadingOrError>
    <div class="p-d-flex p-flex-column p-ai-center p-jc-center" style="min-height:180px;">
      <ng-container *ngIf="loading; else errorState">
        <i class="pi pi-spin pi-spinner dashboard-loading-icon"></i>
        <div class="dashboard-loading-text">Dashboard is loading...</div>
      </ng-container>
      <ng-template #errorState>
        <i class="pi pi-exclamation-triangle" style="font-size: 2rem; color: #f44336; margin-bottom: 1rem;"></i>
        <div class="dashboard-loading-text">Failed to load dashboard data</div>
        <button pButton type="button" label="Retry" class="p-button-outlined" (click)="ngOnInit()" style="margin-top: 1rem;"></button>
      </ng-template>
    </div>
  </ng-template>
</div>
